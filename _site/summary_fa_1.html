<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Efe Baslar" />

<meta name="date" content="2022-04-01" />

<title>Factor Analysis</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CUSA Summaries</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="https://baslare.net">Efe Baslar</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Factor Analysis</h1>
<h4 class="author">Efe Baslar</h4>
<h4 class="date">2022-04-01</h4>

</div>


<p><br></p>
<div id="introduction" class="section level3">
<h3>Introduction</h3>
<p>Hello everyone!</p>
<p>This is called an “RMarkdown” file. You can do all sorts of amazing
stuff using RMarkdown, including preparing pedagogic documents/websites,
showing off your work you do on R, etc. For more details on using R
Markdown see <a href="http://rmarkdown.rstudio.com"
class="uri">http://rmarkdown.rstudio.com</a>.</p>
<p>I’ll be using RMarkdown to prepare the summaries. You can skip the R
sections if you are not interested. But they are much easier to get into
than you’d probably think. Let us start with some preliminaries:</p>
<p><br></p>
</div>
<div id="why-use-it-at-all" class="section level3">
<h3>Why use it at all?</h3>
<p>There are two main reasons why you would want to use factor analysis:
to reduce the number of variables in your data set without using much
information contained within them(for computational reasons), to find
out what may be the latent, unobservable characteristics that your data
set may have that could give you a bigger-picture view on the data you
have (summarisation/for drawing insights) while making it easier to
making sense from the chaos you have in your hands.</p>
<p>Your data set may allow you to indirectly get a measure on those
unobservable characteristics. So you’re basically hitting two birds with
one stone here. After running a factor analysis method and having
factors that adequately explain the variation in your original data set,
you end up having a much manageable data set with similar/correlated
variables grouped together and represented by a variable that can be
named arbitrarily, depending on the context.</p>
<p><br></p>
</div>
<div id="variance-accounted-forexplained" class="section level3">
<h3>Variance accounted for/explained</h3>
<p>You’ve seen the same logic at work in regression analysis. Variance
means information, covariance means the degree of similarity between
information carried by two variables. Covariance makes up the most basic
block in factor analysis, therefore it is important to grasp what it
means.</p>
<p>If we have variables with high correlation, then we can assume that
they have some information in common. You might even say that you have
some duplicate information stored by two variables that you could
compress without losing much, pretty similar (but not identical to) to
what Winrar, Winzip and co. do, we <em>compress</em> the data set while
also making sure that we don’t lose much (unique) information in the
process. <strong>Communality</strong> (<span
class="math inline">\(h^2\)</span>) therefore represents variance
explained in a particular variable by the factors generated, whereas
<strong>uniqueness</strong> (<span class="math inline">\(u^2\)</span>)
represents the variance that the factors are not able to explain, you
could say “information lost” during compression. If you had as many
factors as you have variables, you could perfectly explain the variance
and you would have a communality value of 1 for each variable. But then
it would not make any sense to use factor analysis, would it?</p>
<p>The resulting system of equations in matrix notation looks like the
following, assume there are <span class="math inline">\(m\)</span>
observations, <span class="math inline">\(n\)</span> variables in your
data set and you have reduced your variables to <span
class="math inline">\(r\)</span> factors. This is the system we want to
achieve, we want to decompose our variables in the following way:</p>
<p><span class="math display">\[ X = {\Lambda}F + {\Psi}E\]</span></p>
<p>where X is the <span class="math inline">\(n \times m\)</span> matrix
that stores all the variables we are interested in, <span
class="math inline">\({\Lambda}\)</span> represents the <span
class="math inline">\(n \times r\)</span> <strong>loading</strong>
matrix, that stores the correlations between <span
class="math inline">\(n\)</span> variables and <span
class="math inline">\(r\)</span> factors. <span
class="math inline">\(F\)</span> represents <span
class="math inline">\(r \times m\)</span> matrix of extracted factors,
<span class="math inline">\(\Psi\)</span> is the <span
class="math inline">\(n \times 1\)</span> loading vector for “unique”
factors, which does not appear as a factor when we run an analysis, and
<span class="math inline">\(E\)</span> represents the unique factor, or
error term. This is not a formula, you won’t be able to calculate this
(without having the full factor analysis results in your hands), there
are numerous algorithms that do it for you, mostly using the eigenvalues
of the correlation matrix of the variables in the data set. The variance
is decomposed to explained/unexplained as follows:</p>
<p><span class="math display">\[ \Sigma = \Lambda&#39;\Lambda +
\Psi\]</span></p>
<p><span class="math inline">\(\Lambda\)</span> again represents the
loading matrix and <span class="math inline">\(\Sigma\)</span> is the
covariance matrix of the data set. Our goal when running factor analysis
is to minimize <span class="math inline">\(\Psi\)</span> with the input
we are given. But since all our variables are standardized, they have a
variance of 1</p>
<p><span class="math display">\[ 1 = \Lambda&#39;\Lambda +
\Psi\]</span></p>
<p>which could also be denoted as the following.</p>
<p><span class="math display">\[ 1 = h^2 + u^2\]</span></p>
<p><br></p>
</div>
<div id="distinction---supervised-vs-unsupervised-methods"
class="section level3">
<h3>Distinction - Supervised vs Unsupervised Methods</h3>
<p>We <strong>don’t</strong> have a model to work with in factor
analysis, that makes it an unsupervised method, while it may make sense
to take a look at the correlation matrix beforehand to see if it is
worthwhile to run a factor analysis, we don’t have to pre-group
variables, or even name factors before running. You could argue that the
expression I showed above might qualify as a model, but no, that’s not
what I mean. We have no notion what the factors <strong>must</strong>
look like, contrary to regression where we are trying to make the
combination of our explanatory variables look as much as possible like
the dependent variable. In factor analysis, however, you can have a look
at what the factors <strong>could</strong> look like, but have no say
whatsoever on what they <strong>must</strong> look like. You can think
of a dependent variable as a supervisor that you should obey, we have no
dependent variables in factor analysis.</p>
<p>Yet it still makes sense to have some expectations, and if you don’t
have any variables that can be grouped together (read: high
correlation), you might have to conclude that it is not worth using
factor analysis. Because even if you reduce your data set to a number of
factors, if the variance explained by these factors is around 30%
percent, it will not have made sense to use factor analysis.</p>
<p><br></p>
</div>
<div id="application" class="section level3">
<h3>Application</h3>
<p><strong>Reminder:</strong> even if you are not interested in coding,
it makes sense to read through what’s happening here. Just look at the
tables/results/comments and factor analysis should start making sense,
quite fast.</p>
<p>Let us see how easy it is to run a factor analysis. First, we’ll
include the <code>psych</code> package (install it first if you don’t
have it, as shown below) that gives us the factor analysis function. and
the <code>openxlsx</code> package that lets us import excel files into
R.</p>
<pre class="r"><code>install.packages(&quot;psych&quot;) #install packages, you only need to do it once
install.packages(&quot;openxlsx&quot;)
install.packages(&quot;ggplot2&quot;) #for visualization. I strongly recommend installing and learning how to use the &quot;tidyverse&quot;, which ggplot2 is a part of.
install.packages(&quot;tidyr&quot;) #required for visualization, not necessary for the analysis</code></pre>
<pre class="r"><code>require(psych) #attach the package so that we can work with what it offers to us
require(openxlsx)</code></pre>
<p>Now to use the toothpaste data set! This version is slightly
different than what we have seen in the lecture. so we’ll get rid of the
extra columns. There are packages (e.g. <code>dplyr</code>) that do this
much more elegantly, but let us use the basics for now, as much as
possible.</p>
<pre class="r"><code>toothpaste &lt;- read.xlsx(&quot;https://samuelfranssens.files.wordpress.com/2022/03/toothpaste.xlsx&quot;)
toothpaste &lt;- toothpaste[,-c(1,8,9)]</code></pre>
<p>Take a look at the dataset below:</p>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prevents_cavities
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
shiny_teeth
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
strengthens_gums
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
freshens_breath
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
decay_prevention_unimportant
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
attractive_teeth
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<p>OK, now that we have the data set, let us take a look at the
correlations. R needs only a single function to give you the correlation
matrix! But before that, let us make sure that we standardize all the
variables in the data set. <code>apply()</code> is one of the ways to
implement a loop in R and it is not necessarily related to factor
analysis. What we are doing is the usual <em>z-standardization</em>:</p>
<p><span class="math display">\[ z = \frac{x -
{\mu}_x}{{\sigma}_x}\]</span></p>
<pre class="r"><code>toothpaste &lt;- apply(toothpaste,MARGIN = 2, function(x) (x -mean(x))/sd(x))
cor_mat &lt;- cor(toothpaste) #finding the correlation matrix</code></pre>
<p>The following part deals with visualization and it is by no means
essential, if you are into data visualization, ggplot2 is an amazing
library to learn as it gives endless customization options! Don’t worry
about this part, as it features some stuff necessary for visualizing the
correlation matrix.</p>
<pre class="r"><code>require(tidyr) #
require(ggplot2) #
cor_mat &lt;- data.frame(cor_mat) #finding the correlation matrix
cor_mat$var1 &lt;- rownames(cor_mat)
cor_mat &lt;- cor_mat %&gt;% pivot_longer(cols = prevents_cavities:attractive_teeth)


ggplot(data = cor_mat, aes(var1, name, fill = value))+
 geom_tile(color = &quot;white&quot;,alpha=0.75)+
 geom_text(aes(label=round(value,2),color=value)) +
 scale_fill_gradient2(low = &quot;blue&quot;, high = &quot;red&quot;, mid = &quot;white&quot;, 
   midpoint = 0, limit = c(-1,1), space = &quot;Lab&quot;,
   name=&quot;Pearson\nCorrelation&quot;) +
 scale_color_gradient2(low = &quot;darkblue&quot;, high = &quot;darkred&quot;, mid = &quot;gray&quot;, 
   midpoint = 0, limit = c(-1,1), space = &quot;Lab&quot;,guide = &quot;none&quot;) +
 theme_minimal()+ 
 theme(axis.text.x = element_text(angle = 45, vjust = 1, 
     hjust = 1))+
 coord_fixed() + labs(x=&quot;&quot;,y=&quot;&quot;)</code></pre>
<p><img src="summary_fa_1_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>You can see that, as discussed in the class, there is a strong
(positive or negative) correlation between the variables
<code>strengthens_gums</code>,<code>decay_preventaion_unimportant</code>
and <code>prevents_cavities</code>, which we can group under “health
concerns” and
<code>attractive_teeth</code>,<code>freshens_breath</code>, and
<code>shiny_teeth</code> under “aesthetic concerns”. This grouping is
not necessary for factor analysis, however, as I mentioned above it is
nice see whether it is worthwhile to do a factor analysis, as the
correlations are the building blocks of factor analysis. With no strong
correlation, we cannot expect to have factors that can cover the
variance in variables well enough.</p>
<p><strong>Reminder:</strong> Factor analysis first calculates the
eigenvalues, loadings and communalities before actually extracting the
factors themselves. Luckily, the <code>psych</code> package gives us a
function to create a scree plot without extracting factors one by
one.</p>
<p>In the figure below, we are interested in the dashed line. Don’t get
confused, algorithms for factor analysis deal with eigenvalues of
modified correlation matrices at each iteration. There is an other
method called <em>Principal Component Analysis</em> that is in some ways
similar to Factor Analysis, but we are not interested in that at the
moment.</p>
<p>Anyway, the dashed line gives us the eigenvalues we are interested
in. After the second factor, the marginal explanation power of each
factor dips dramatically. So, it would be wise to go with 2 factors for
this dataset.</p>
<pre class="r"><code>psych::scree(toothpaste) # the part before &quot;::&quot; is the package name, sometimes it necessary to use it to avoid naming conflicts, I used it here to demonstrate it for two reasons: 1) to show you that such functionality exists, e.g. you can call a function without including its package 2)because the built-int &quot;stats&quot; package has a function with the same name.</code></pre>
<p><img src="summary_fa_1_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>We are now ready to go through with 2 factors as our selection.
Running a factor analysis, again, is very simple with R. As you can see
just below. Let us first choose the no-rotation version and use that as
a basis this has the assumption that factors are uncorrelated with each
other (We don’t really know at the moment if that assumption has any
truth to it).</p>
<p><strong>Reminder:</strong> we are able to use the entire data set
inside the <code>fa()</code> function because we want to use all the
variables for the analysis, if we did not need all the variables then we
would have to modify the data frame to work with a subset of the
variables.</p>
<p>Below we have a factor analysis output. Let us investigate it. Don’t
panic, we are not interested (at least immediately) everything that is
written in the report.</p>
<pre class="r"><code>fact_result_nr &lt;- fa(toothpaste,nfactors = 2,rotate = &quot;none&quot;)
fact_result_nr</code></pre>
<pre><code>## Factor Analysis using method =  minres
## Call: fa(r = toothpaste, nfactors = 2, rotate = &quot;none&quot;)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                                MR1   MR2   h2    u2 com
## prevents_cavities             0.95  0.17 0.93 0.071 1.1
## shiny_teeth                  -0.21  0.72 0.56 0.439 1.2
## strengthens_gums              0.91  0.04 0.84 0.164 1.0
## freshens_breath              -0.25  0.73 0.60 0.401 1.2
## decay_prevention_unimportant -0.85 -0.26 0.79 0.211 1.2
## attractive_teeth             -0.10  0.85 0.72 0.275 1.0
## 
##                        MR1  MR2
## SS loadings           2.57 1.87
## Proportion Var        0.43 0.31
## Cumulative Var        0.43 0.74
## Proportion Explained  0.58 0.42
## Cumulative Proportion 0.58 1.00
## 
## Mean item complexity =  1.1
## Test of the hypothesis that 2 factors are sufficient.
## 
## The degrees of freedom for the null model are  15  and the objective function was  4.25 with Chi Square of  238.93
## The degrees of freedom for the model are 4  and the objective function was  0.22 
## 
## The root mean square of the residuals (RMSR) is  0.02 
## The df corrected root mean square of the residuals is  0.05 
## 
## The harmonic number of observations is  60 with the empirical chi square  1.1  with prob &lt;  0.89 
## The total number of observations was  60  with Likelihood Chi Square =  11.82  with prob &lt;  0.019 
## 
## Tucker Lewis Index of factoring reliability =  0.866
## RMSEA index =  0.18  and the 90 % confidence intervals are  0.067 0.306
## BIC =  -4.56
## Fit based upon off diagonal values = 1
## Measures of factor score adequacy             
##                                                    MR1  MR2
## Correlation of (regression) scores with factors   0.98 0.92
## Multiple R square of scores with factors          0.95 0.85
## Minimum correlation of possible factor scores     0.91 0.70</code></pre>
<p>The first table gives us the most vital values:
<strong>loadings</strong> (MR1 and MR2), <strong>communalities</strong>
(h2) and <strong>uniqueness</strong> (u2).</p>
<p>The second table present different measures for variance explained.
The metric of interest is, “cumulative variance”. We can see here that
two factors explain 74% of the total variance in the data set! Which is
a great result.</p>
<p>Let’s talk about <strong>loadings</strong> and how central they are
to a factor analysis model. Remember that each loading is a correlation
value between the given variable and the factor. Let us extract
loadings. I’ll demonstrate how you can get
<strong>communalities</strong> and <strong>eigenvalues</strong>, which
correspond to how explained a variable is and how explanatory a factor
is, respectively. We can square the loadings and sum squared loadings
for each variable to find communalities, and sum squared loadings for
each factor to find eigenvalues.</p>
<pre class="r"><code>ldg &lt;- as.data.frame(fact_result_nr$loadings[]) #this is some weird syntax, don&#39;t dwell on it. 
knitr::kable(ldg,col.names = c(&quot;Factor 1&quot;,&quot;Factor 2&quot;)) %&gt;% kableExtra::kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Factor 1
</th>
<th style="text-align:right;">
Factor 2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
prevents_cavities
</td>
<td style="text-align:right;">
0.9493111
</td>
<td style="text-align:right;">
0.1679548
</td>
</tr>
<tr>
<td style="text-align:left;">
shiny_teeth
</td>
<td style="text-align:right;">
-0.2062724
</td>
<td style="text-align:right;">
0.7201383
</td>
</tr>
<tr>
<td style="text-align:left;">
strengthens_gums
</td>
<td style="text-align:right;">
0.9134100
</td>
<td style="text-align:right;">
0.0382759
</td>
</tr>
<tr>
<td style="text-align:left;">
freshens_breath
</td>
<td style="text-align:right;">
-0.2461427
</td>
<td style="text-align:right;">
0.7336414
</td>
</tr>
<tr>
<td style="text-align:left;">
decay_prevention_unimportant
</td>
<td style="text-align:right;">
-0.8493783
</td>
<td style="text-align:right;">
-0.2591322
</td>
</tr>
<tr>
<td style="text-align:left;">
attractive_teeth
</td>
<td style="text-align:right;">
-0.1010156
</td>
<td style="text-align:right;">
0.8452070
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># the pipe operator ( %&gt;% ) is an essential component in modern R. You can think of it as applying another layer to whatever object you are working with.
as.matrix(ldg)^2 %&gt;%  knitr::kable(col.names = c(&quot;Squared F1&quot;,&quot;Squared F2&quot;)) %&gt;% kableExtra::kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Squared F1
</th>
<th style="text-align:right;">
Squared F2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
prevents_cavities
</td>
<td style="text-align:right;">
0.9011915
</td>
<td style="text-align:right;">
0.0282088
</td>
</tr>
<tr>
<td style="text-align:left;">
shiny_teeth
</td>
<td style="text-align:right;">
0.0425483
</td>
<td style="text-align:right;">
0.5185991
</td>
</tr>
<tr>
<td style="text-align:left;">
strengthens_gums
</td>
<td style="text-align:right;">
0.8343179
</td>
<td style="text-align:right;">
0.0014650
</td>
</tr>
<tr>
<td style="text-align:left;">
freshens_breath
</td>
<td style="text-align:right;">
0.0605862
</td>
<td style="text-align:right;">
0.5382298
</td>
</tr>
<tr>
<td style="text-align:left;">
decay_prevention_unimportant
</td>
<td style="text-align:right;">
0.7214435
</td>
<td style="text-align:right;">
0.0671495
</td>
</tr>
<tr>
<td style="text-align:left;">
attractive_teeth
</td>
<td style="text-align:right;">
0.0102041
</td>
<td style="text-align:right;">
0.7143748
</td>
</tr>
</tbody>
</table>
<p>The first table above shows us the loadings, second the squared
loadings. Squared loadings correspond to the variance in a particular
variable explained by a particular factor, whereas loadings correspond
the correlations between each variable and each factor. The table below,
on the other hand, shows us the sum of squared loadings for each factor.
Notice that they are identical to the results in the factor analysis
output.</p>
<pre class="r"><code>as.matrix(ldg)^2  %&gt;% apply(MARGIN = 2,sum) %&gt;% knitr::kable(col.names = c(&quot;Eigenvalues&quot;)) %&gt;% kableExtra::kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Eigenvalues
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
MR1
</td>
<td style="text-align:right;">
2.570292
</td>
</tr>
<tr>
<td style="text-align:left;">
MR2
</td>
<td style="text-align:right;">
1.868027
</td>
</tr>
</tbody>
</table>
<p>For communalities you can take a look at the table below. Notice,
again, that they are identical to <span
class="math inline">\(h^2\)</span> results in the original factor
analysis output above.</p>
<pre class="r"><code>as.matrix(ldg)^2  %&gt;% apply(MARGIN = 1,sum) %&gt;% knitr::kable(col.names = c(&quot;Communalities&quot;)) %&gt;% kableExtra::kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Communalities
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
prevents_cavities
</td>
<td style="text-align:right;">
0.9294004
</td>
</tr>
<tr>
<td style="text-align:left;">
shiny_teeth
</td>
<td style="text-align:right;">
0.5611474
</td>
</tr>
<tr>
<td style="text-align:left;">
strengthens_gums
</td>
<td style="text-align:right;">
0.8357829
</td>
</tr>
<tr>
<td style="text-align:left;">
freshens_breath
</td>
<td style="text-align:right;">
0.5988160
</td>
</tr>
<tr>
<td style="text-align:left;">
decay_prevention_unimportant
</td>
<td style="text-align:right;">
0.7885930
</td>
</tr>
<tr>
<td style="text-align:left;">
attractive_teeth
</td>
<td style="text-align:right;">
0.7245790
</td>
</tr>
</tbody>
</table>
<p><br></p>
<div id="rotations" class="section level4">
<h4>Rotations</h4>
<p>refer to <a
href="http://static.esmt.org/pub/edtech/customer_perceptions.html"
class="uri">http://static.esmt.org/pub/edtech/customer_perceptions.html</a>
for a detailed account of factor rotations.</p>
<p><br></p>
</div>
<div id="factors-scores" class="section level4">
<h4>Factors Scores</h4>
<p>Factors are readily available in the factor analysis output object
-unless otherwise stated-, and can be accessed as follows:</p>
<pre class="r"><code>fac_scores &lt;- fact_result_nr$scores
knitr::kable(fac_scores) %&gt;% kableExtra::kable_styling() %&gt;%  kableExtra::scroll_box(width = &quot;100%&quot;, height = &quot;200px&quot;)</code></pre>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
MR1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
MR2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.3371546
</td>
<td style="text-align:right;">
0.0777128
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.2042479
</td>
<td style="text-align:right;">
-0.5292726
</td>
</tr>
<tr>
<td style="text-align:right;">
1.3008765
</td>
<td style="text-align:right;">
-0.5992375
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0574518
</td>
<td style="text-align:right;">
0.9478862
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.1395018
</td>
<td style="text-align:right;">
-1.6829693
</td>
</tr>
<tr>
<td style="text-align:right;">
1.0325559
</td>
<td style="text-align:right;">
-0.0398628
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6441449
</td>
<td style="text-align:right;">
-0.8122027
</td>
</tr>
<tr>
<td style="text-align:right;">
1.1751724
</td>
<td style="text-align:right;">
0.1242133
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.6560086
</td>
<td style="text-align:right;">
-0.7243674
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.3677483
</td>
<td style="text-align:right;">
1.1414842
</td>
</tr>
<tr>
<td style="text-align:right;">
1.1696141
</td>
<td style="text-align:right;">
-0.4827841
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.0194113
</td>
<td style="text-align:right;">
-0.3512548
</td>
</tr>
<tr>
<td style="text-align:right;">
1.4857131
</td>
<td style="text-align:right;">
-0.4212196
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.1482193
</td>
<td style="text-align:right;">
1.2575362
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.1669198
</td>
<td style="text-align:right;">
-0.9556045
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9566932
</td>
<td style="text-align:right;">
-0.1001608
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7074943
</td>
<td style="text-align:right;">
-0.3944878
</td>
</tr>
<tr>
<td style="text-align:right;">
1.5351708
</td>
<td style="text-align:right;">
0.0650375
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.8408452
</td>
<td style="text-align:right;">
-0.9023852
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.6532255
</td>
<td style="text-align:right;">
1.1651669
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.1315521
</td>
<td style="text-align:right;">
-1.0885031
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5527955
</td>
<td style="text-align:right;">
0.0797553
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.9435486
</td>
<td style="text-align:right;">
-0.2909567
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2991692
</td>
<td style="text-align:right;">
1.7689997
</td>
</tr>
<tr>
<td style="text-align:right;">
0.8760687
</td>
<td style="text-align:right;">
0.1037265
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.5483681
</td>
<td style="text-align:right;">
1.4746727
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5883985
</td>
<td style="text-align:right;">
-0.1673218
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.8390729
</td>
<td style="text-align:right;">
0.4692681
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.3202141
</td>
<td style="text-align:right;">
2.1142582
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.0263481
</td>
<td style="text-align:right;">
-1.2471268
</td>
</tr>
<tr>
<td style="text-align:right;">
1.3371546
</td>
<td style="text-align:right;">
0.0777128
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.2042479
</td>
<td style="text-align:right;">
-0.5292726
</td>
</tr>
<tr>
<td style="text-align:right;">
1.3008765
</td>
<td style="text-align:right;">
-0.5992375
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0574518
</td>
<td style="text-align:right;">
0.9478862
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.1395018
</td>
<td style="text-align:right;">
-1.6829693
</td>
</tr>
<tr>
<td style="text-align:right;">
1.0325559
</td>
<td style="text-align:right;">
-0.0398628
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6441449
</td>
<td style="text-align:right;">
-0.8122027
</td>
</tr>
<tr>
<td style="text-align:right;">
1.1751724
</td>
<td style="text-align:right;">
0.1242133
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.6560086
</td>
<td style="text-align:right;">
-0.7243674
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.3677483
</td>
<td style="text-align:right;">
1.1414842
</td>
</tr>
<tr>
<td style="text-align:right;">
1.1696141
</td>
<td style="text-align:right;">
-0.4827841
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.0194113
</td>
<td style="text-align:right;">
-0.3512548
</td>
</tr>
<tr>
<td style="text-align:right;">
1.4857131
</td>
<td style="text-align:right;">
-0.4212196
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.1482193
</td>
<td style="text-align:right;">
1.2575362
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.1669198
</td>
<td style="text-align:right;">
-0.9556045
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9566932
</td>
<td style="text-align:right;">
-0.1001608
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7074943
</td>
<td style="text-align:right;">
-0.3944878
</td>
</tr>
<tr>
<td style="text-align:right;">
1.5351708
</td>
<td style="text-align:right;">
0.0650375
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.8408452
</td>
<td style="text-align:right;">
-0.9023852
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.6532255
</td>
<td style="text-align:right;">
1.1651669
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.1315521
</td>
<td style="text-align:right;">
-1.0885031
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5527955
</td>
<td style="text-align:right;">
0.0797553
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.9435486
</td>
<td style="text-align:right;">
-0.2909567
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2991692
</td>
<td style="text-align:right;">
1.7689997
</td>
</tr>
<tr>
<td style="text-align:right;">
0.8760687
</td>
<td style="text-align:right;">
0.1037265
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.5483681
</td>
<td style="text-align:right;">
1.4746727
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5883985
</td>
<td style="text-align:right;">
-0.1673218
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.8390729
</td>
<td style="text-align:right;">
0.4692681
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.3202141
</td>
<td style="text-align:right;">
2.1142582
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.0263481
</td>
<td style="text-align:right;">
-1.2471268
</td>
</tr>
</tbody>
</table>
</div>
<p>We now have reduced our data set of 6 variables, effectively to just
2 variables, while still retaining the 74% of the variance that exists
in the original data set. We are now ready to use these factors as
inputs in a different analysis! Note that all the factors have 0 mean
and 1 variance, as this is how they are constructed.</p>
<p><br></p>
</div>
</div>
<div id="questions" class="section level3">
<h3>Questions</h3>
<p>These are the questions I gathered from the whiteboard in section
2.7</p>
<ul>
<li><strong>Is communality and eigenvalue are the same?</strong></li>
</ul>
<p>No, communalities represent how well the original variables are
explained by the factors constructed, whereas eigenvalues exist to show
us how explanatory a factor is.</p>
<ul>
<li><strong>Why common factors has a mean = 0 and
variance=1?</strong></li>
</ul>
<p>Aside from between factor standardization (e.g. making it easier to
compare the first factor to the second), having a zero mean and a
variance of 1 makes it much easier to compute different components of
factor analysis. If you are interested, you can take a look at any
textbook dealing with factor analysis. Moreover, not only common factors
have zero mean and unit variance but unique factors have the same
properties as well.</p>
<ul>
<li><strong>What is the sequential order in factor analysis? (eg: first
determine which factors to extract by looking at eigenvalue, second give
factors a name (if ambiguous apply rotation), third validate if total
variance explained by selected factors is satisfactory)</strong></li>
</ul>
<p>The workflow is pretty much given above but yes this is more or less
how it happens. But we don’t have to extract factors to see how much
variance is explained by the selected number of factors, that’s why we
use the scree plot in the first place.</p>
<ul>
<li><strong>Could you share an example where oblique rotation is more
useful rather than orthogonal rotation?</strong></li>
</ul>
<p>This depends on whether factors are correlated with each other or
not.</p>
<ul>
<li><strong>Why is it assumed that the total number of possible factors
equals the total number of variables?</strong></li>
</ul>
<p>Well, that is because the correlation matrix of the variables have
the dimension <span class="math inline">\(n \times n\)</span>, where
<span class="math inline">\(n\)</span> is the number of variables we
have. Recall that the correlation matrix is the cornerstone to building
a factor analysis model. We just don’t have any information to build
more factors than there are variables in our data set.</p>
<ul>
<li><strong>Why in the toothpaste problem we assume from the beginning
there are just two factors? Shouldn´t we have considered that there
might be 6 possible factors until we have extracted the Eigenvalues and
extracted the scree plots?</strong></li>
</ul>
<p>We can see how many factors would make sense to use by taking a look
at the scree plot, that doesn’t require us to extract the factors.
Besides, if we go for <span class="math inline">\(n\)</span> factors
when there are <span class="math inline">\(n\)</span> variables, we are
not really pursuing any goal that can be pursued with factor analysis:
we’re not reducing dimensions and we’re not summarizing anything.</p>
<ul>
<li><strong>Do we work with the factor scores with the values before or
after the rotation?</strong></li>
</ul>
<p>We can still have factor scores without applying any rotation, that
would be the “no rotation” case. With a rotation, however, yes we would
first have to apply rotation to work with rotated factor scores.</p>
<ul>
<li><strong>How could we work with them if there are more than two
factors?</strong></li>
</ul>
<p>We are not only interested in visualization here. Imagine you want to
run a regression model: the principle of parsimony tells us that we
should use as few variables as possible when building a model. Factor
analysis provides us with a method here for that. This becomes even
crucial if you are dealing with huge data sets with many variables.
Bonus concept: <a href="https://en.wikipedia.org/wiki/Occam%27s_razor"
class="uri">https://en.wikipedia.org/wiki/Occam%27s_razor</a></p>
<ul>
<li><strong>Should we use the orthogonal rotation as our preferred one
and only go to the oblique rotation if the first one does not
work?</strong></li>
</ul>
<p>Well, this is somehow related to my answer just above, if you can,
don’t make it more complicated than it is. If the factors are
uncorrelated then it does not really make sense to use an oblique
rotation. It would just be against the principle of parsimony. There
could be some cases in which it would be useful, but in general, I would
not do it.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
